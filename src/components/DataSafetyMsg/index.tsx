import { Button, Popup } from "tdesign-mobile-react"
import { PopupSource } from "tdesign-mobile-react/es/popup/type"
import './index.css';
import { useEffect, useState } from "react";
const DataSafetyMsg = (props: { visible: boolean | undefined; onClick: React.MouseEventHandler<HTMLDivElement>;}) => {
    const [time, setTime] = useState(10);
    useEffect(() => {
            if (time > 0) {
                const timerId = setInterval(() => {
                    setTime(prevCount => prevCount - 1);
                }, 1000);
                return () => {
                    clearInterval(timerId);
                };
            }
        }, [time])
    return (
        <Popup
            visible={props?.visible}
            placement='bottom'
        >
            <div className="data-safety-msg">
                <div className="title">数据安全说明</div>
                <div className="msg">
                    <div>本政策说明我们在提供虚拟试穿功能时如何收集、使用、保存、共享与保护您的个人信息和数据安全，并与《用户协议》共同适用。我们遵循最小必要、目的限定、公开透明、确保安全原则，依据相关法律法规开展处理。</div>
                    <p>1. 我们收集的信息及用途（目的限定 & 最小必要）</p>
                    <div>影像数据：您主动上传/拍摄的环拍视频、照片（含美颜）</div>
                    <div>用途：生成与回看试穿效果。</div>
                    <div>由影像计算生成的数据：人体/人脸关键点坐标、姿态/体型参数估计值、算法特征向量、渲染缓存</div>
                    <div>用途：拟合与渲染、尺寸/褶皱/垂坠模拟、效果优化。</div>
                    <div>设备与日志信息：设备型号、系统版本、网络类型、崩溃/错误日志、操作记录、IP等</div>
                    <div>用途：账号安全、反作弊、性能统计、故障排查。</div>
                    <div>账号及交易必要信息（如手机号/邮箱、订单与支付必要要素）</div>
                    <div>用途：登录、身份核验、客服与依法配合审计。</div>
                    <p>说明：除非另行取得明示同意，上述信息不用于身份识别或对外营销；如后续引入“用于算法改进/个性化推荐”等可选处理，将以单独勾选方式征得您的同意，未同意不影响核心试穿功能。</p>
                    <p>2. 权限调用与撤回</p>
                    <p>相机、相册/媒体、存储、网络、通知等权限仅在您授权后按场景调用；您可在系统设置中随时撤回，撤回后不影响非核心功能的使用。</p>
                    <p>3. 敏感个人信息声明</p>

                    <p>影像数据及由此产生的体型参数可能属于敏感个人信息。我们仅在您主动提供并明示同意的前提下用于虚拟试穿；不开展人脸比对/身份验证等与本功能无关的用途，除非另行取得您的明示同意。</p>
                    <p>4. 处理与安全措施</p>


                    <p>加密：传输采用 TLS，加密存储采用行业通用强度（如 AES-256）。</p>

                    <p>去标识化/最小化：优先以特征向量/关键点参与计算，减少原始影像暴露。</p>

                    <p>访问控制与审计：最小权限、双人审批、密钥托管与轮换、全量访问审计与告警。</p>


                    <p>组织与流程：人员保密与安全培训、供应商安全评估、变更与上线审批、定期安全测试与合规对标。</p>

                    <p>算法透明：对自动化生成的试穿结果提供可解释说明与人工复核渠道，避免不合理差异化对待。</p>


                    <p>5. 存储地点与期限</p>

                    <p>地域：原则上在中国境内存储与处理；如需跨境传输，将依法评估并另行取得您的明示同意。</p>

                    <p>期限：</p>


                    <p>原始环拍视频/照片：默认 7 天自动删除（或在完成渲染后立即删除，可由您在设置中选择）；</p>



                    <p>特征向量/渲染缓存/日志：最长 12 个月，期满删除或匿名化；</p>
                    <p>因法定要求需留存的，按法律规定的最短期限保留。</p>

                    <p>6. 共享、转移与委托处理</p>
                    <p>我们不出售您的个人信息。仅在实现功能或保障安全所必需时，与云计算与存储、统计与崩溃分析、支付/风控、短信/邮件等服务商合作，并签署数据处理协议，明确目的、范围、安全责任与删除要求，且不得超范围处理。发生合并/重组/破产等导致信息转移时，我们将告知您并至少按不低于本政策的标准保护或重新征得同意。</p>
                    <p>7. 自动化决策</p>

                    <p>试穿效果主要由算法自动生成。您有权要求说明并申请人工复核或提出不同意见的处理。</p>

                    <p>8. 您的权利与行使方式</p>

                    <p>您可通过【设置—隐私】或联系客服，行使：知情权、查询/复制权、更正权、删除权、撤回同意权、限制/拒绝处理权、数据可携权、账号注销权等。我们将在15 个工作日内答复（法律法规另有时限从其规定）。</p>


                    <p>支持一键删除原始影像与特征向量；删除为不可逆操作。</p>

                    <p>9. 未成年人保护</p>

                    <p>未满 14 周岁的用户需由监护人明示同意后方可使用；14–18 周岁建议在监护指导下使用。监护人可随时联系我们删除相关信息。</p>

                    <p>10. 个人信息安全事件处置</p>
                    <p>如发生或可能发生个人信息安全事件，我们将立即启动应急预案，并在符合法律法规的期限内告知您与监管部门事件情况、可能影响、采取的措施与补救建议。</p>
                    <p>11. 第三方 SDK / 合作方清单（长期公示）</p>

                    <p>我们将在应用内长期公示并动态更新清单（名称/提供方、接入目的、处理数据类型与频率、处理方式、退订路径）。（上线前请补充具体 SDK 明细表）</p>

                    <p>12. 政策更新与通知</p>

                    <p>本政策若发生重要变更，我们将通过弹窗/站内信/版本更新说明等显著方式通知，并在必要时再次征求同意。 </p>



                </div>
                <div className='data-safety-msg-btn'>
                    <Button size="large" theme="light" disabled={time > 0} onClick={(e: any) => props.onClick(e)} block shape="round" style={{ border: 0, background: 'linear-gradient(90deg, #27DC9A 0%, #02DABF 100%)', color: '#fff' }}>{time > 0 ? `${time}s 后可点击确认` : '我已知晓'}</Button>
                </div>
            </div>
        </Popup>
    )
}

export default DataSafetyMsg